#{extends 'main.html' /}

#{set 'moreScripts'}
<script type="text/javascript">
    $(document).ready(function()
    {
        CKEDITOR.replace('metricProduct_description', {
            toolbar: [ [ 'Bold', 'Italic', 'Underline', 'Subscript', 'Superscript' ] ],
            coreStyles_bold	: { element : 'b' },
		    coreStyles_italic : { element : 'i' },
            enterMode: CKEDITOR.ENTER_BR
        });

        CKEDITOR.replace('metricProduct_comments', {
            toolbar: [ [ 'Bold', 'Italic', 'Underline', 'Subscript', 'Superscript' ] ],
            coreStyles_bold	: { element : 'b' },
		    coreStyles_italic : { element : 'i' },
            enterMode: CKEDITOR.ENTER_BR
        });

        createAutocomplete($('#metricProduct_supplier_id'), "@{Contacts.search}", #{jsAction @Contacts.popover(':id') /}, "${messages.get('contact')}");
    });
</script>
#{/set}

#{form @save(), class:'form-horizontal'}
#{field property:'metricProduct.id', object:metricProduct}
<input type="hidden" value="${field.value}" name="${field.name}"/>
#{/field}

<fieldset>
    <legend>&{'metricProduct'}</legend>

    #{textField property:'metricProduct.name', object:metricProduct /}

    #{textArea property:'metricProduct.description', object:metricProduct /}

    %{
        if(metricProduct?.supplier?.id != null) {
            args = new java.util.HashMap<String, Object>();
            args.put('id', metricProduct.supplier.id);
            help = '<span class="label" rel="popover" title="' + messages.get('contact') + '" data-source="' + play.mvc.Router.reverse('Contacts.popover', args) + '">Info</span> ';
        } else {
            help = '<a href="' + play.mvc.Router.reverse('Contacts.modalForm') + '" modal="modal" target="metricProduct_supplier_id">' + messages.get('create', messages.get('contact')) + '</a>';
        }
    }%
    #{autocompleteTextField property:'metricProduct.supplier.id', object:metricProduct, label:metricProduct?.supplier?.label, help:help.raw() /}

    #{textField property:'metricProduct.orderNumber', object:metricProduct /}

    #{field property:'metricProduct.metric.id', object:metricProduct}
    <div class="control-group">
        <label for="${field.id}">&{field.name}</label>
        <div class="controls">
            #{select field.name, items:metrics, valueProperty:'id', labelProperty:'symbol', value:metricProduct?.metric?.id, id:field.id /}
        </div>
    </div>
    #{/field}

    #{textField property:'metricProduct.priceUnit', object:metricProduct /}

    #{textField property:'metricProduct.purchasePricePerMetric.rawValue', object:metricProduct, help:defaultCurrency.getCurrencyCode() /}

    #{field property:'metricProduct.purchasePricePerMetric.currencyCode', object:metricProduct}
    <input type="hidden" value="${defaultCurrency.getCurrencyCode()}" name="${field.name}"/>
    #{/field}

    #{textField property:'metricProduct.retailPricePerMetric.rawValue', object:metricProduct, help:defaultCurrency.getCurrencyCode() /}

    #{field property:'metricProduct.retailPricePerMetric.currencyCode', object:metricProduct}
    <input type="hidden" value="${defaultCurrency.getCurrencyCode()}" name="${field.name}"/>
    #{/field}

    #{field property:'metricProduct.valueAddedTaxRate.id', object:metricProduct}
    <div class="control-group">
        <label for="${field.id}">&{field.name}</label>
        <div class="controls">
            #{select field.name, items:valueAddedTaxRates, valueProperty:'id', labelProperty:'description', value:metricProduct?.valueAddedTaxRate?.id, id:field.id /}
        </div>
    </div>
    #{/field}

    #{textArea property:'metricProduct.comments', object:metricProduct /}

</fieldset>

<div class="form-actions">
    <input type="submit" class="btn btn-primary" value="&{'submit'}">
    <a href="@{index}" class="btn">&{'cancel'}</a>
</div>
#{/form}

<div id="modal" class="modal fade hide"></div>